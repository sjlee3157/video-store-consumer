(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{125:function(e,t,a){e.exports=a(349)},135:function(e,t,a){},142:function(e,t,a){},144:function(e,t,a){},146:function(e,t,a){},297:function(e,t,a){},299:function(e,t,a){},320:function(e,t,a){},322:function(e,t,a){},324:function(e,t,a){},326:function(e,t,a){},335:function(e,t,a){},337:function(e,t,a){},339:function(e,t,a){},341:function(e,t,a){},343:function(e,t,a){},346:function(e,t,a){},349:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(52),o=a.n(c),l=(a(135),a(33)),s=a.n(l),i=a(53),u=a(5),m=a(6),d=a(8),h=a(7),v=a(9),f=a(348),b=a(350),p=a(352),E=(a(80),a(22)),C=(a(142),function(){return r.a.createElement("h1",null,"Webflix. Reimagined.")}),g=(a(144),a(32)),k=(a(146),a(119)),y=a.n(k),O=(a(148),a(31)),j=a.n(O),M=(a(297),function(e){var t=j()(e.releaseDate).format("MMM Do, YYYY");return r.a.createElement("div",{className:"card-body"},r.a.createElement("img",{className:"card-img-top",src:e.imageUrl,alt:e.title}),r.a.createElement("h3",{className:"card-title"},e.title),r.a.createElement("p",{className:"card-subtitle"},r.a.createElement("small",{className:"text-muted"},"Released on: ",t)),r.a.createElement("p",{className:"card-text"},e.overview))}),w=(a(299),a(19)),_=a.n(w),N=function(e){return r.a.createElement("button",{className:"button",onClick:function(){!function(e){_.a.post("http://localhost:3000/movies",e).then(function(t){console.log(t,e),e.renderAlertCallback({success:"".concat(e.title," successfully added.")})}).catch(function(t){console.log(t.response.data.errors),e.renderAlertCallback({failure:"".concat(t.response.data.errors)})})}(e)}},"+ Add To Our Library")},S=(a(320),function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).onFormChange=function(t){var a=t.target.value;e.setState({query:a}),e.props.onFilterChangeCallback(a),console.log("Filter search term: ".concat(a))},e.onSubmitHandler=function(e){e.preventDefault()},e.state={query:""},e}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=r.a.createElement(E.a,{icon:"search"});return r.a.createElement("section",null,r.a.createElement("form",{onSubmit:this.onSubmitHandler,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"},r.a.createElement("input",{onClick:this.clearForm,className:"searchbar__form-input",onChange:this.onFormChange,value:this.state.query,placeholder:"Filter Search Results",size:"40"}),r.a.createElement("button",{className:"button button-search",type:"submit",name:"submit"},e)))}}]),t}(n.Component)),A=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).onFilterChange=function(e){console.log(e);var t=new RegExp(e,"i"),n=a.state.masterListSearchResults.filter(function(e){var a=e.title+" "+e.overview;return t.test(a)});a.setState({searchResults:n})},a.mapRowToCards=function(e){return e.map(function(e,t){return r.a.createElement("div",{className:"search-results__card card movie-card",key:t},r.a.createElement(M,{key:t,externalId:e.external_id,id:e.id,imageUrl:e.image_url,overview:e.overview,releaseDate:e.release_date,title:e.title}),r.a.createElement(N,Object.assign({},e,{inventory:5,renderAlertCallback:a.props.renderAlertCallback})))})},a.state={searchResults:[],masterListSearchResults:[]},a}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"search-results__wrapper"},r.a.createElement(S,{onFilterChangeCallback:this.onFilterChange}),function(){var t=y.a.chunk(e.state.searchResults,4).flatMap(function(t,a){return r.a.createElement("div",{className:"card-group",key:a},e.mapRowToCards(t))});return console.log("Successfully Loaded ".concat(t.length," Search Results"),t),t}())}},{key:"getMovies",value:function(){var e=this,t="http://localhost:3000/movies?query="+this.props.query;_.a.get(t).then(function(t){console.log("API GET MOVIES"),console.log(t);var a=t.data.map(function(e){return Object(g.a)({},e)});e.setState({masterListSearchResults:a,searchResults:a})}).catch(function(e){console.log(e.message)})}},{key:"componentDidMount",value:function(){""!==this.props.query&&this.getMovies()}},{key:"componentDidUpdate",value:function(e){""!==this.props.query&&(console.log("update list"),this.props.query!==e.query&&this.getMovies())}}]),t}(n.Component),R=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null," Search Results"),r.a.createElement(A,{query:this.props.query,renderAlertCallback:this.props.renderAlertCallback}))}}]),t}(n.Component),q=(a(322),a(324),a(326),function(e){e.movie?e.movie.title:e.customer.name;var t=r.a.createElement("button",{className:"button",onClick:function(){return e.selectMovieCallback(e.movie)}},"+ Add To Rental"),a=r.a.createElement("button",{className:"button",onClick:function(){return e.selectCustomerCallback(e.customer)}},"+ Add As Renter");return r.a.createElement("div",{className:"button"},"selectMovie"===e.buttonType&&t,"selectCustomer"===e.buttonType&&a)}),F=(a(328),a(120)),T=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).state={movies:[]},e}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state.movies.reverse().map(function(t,a){var n=j()(t.release_date).format("MMM Do, YYYY");return r.a.createElement("div",{className:"card movie-carousel__movie",key:a},r.a.createElement(q,{buttonType:"selectMovie",movie:t,selectMovieCallback:e.props.selectMovieCallback}),r.a.createElement("img",{className:"card-img-top movie-carousel__movie-image",src:t.image_url,alt:"".concat(t.title)}),r.a.createElement("div",{className:"card-body"},r.a.createElement("h3",{className:"card-title"},t.title),r.a.createElement("p",{className:"card-subtitle"},r.a.createElement("small",{className:"text-muted"},"Released on: ",n)),r.a.createElement("p",{className:"card-text"},t.overview)))});return r.a.createElement("div",{className:"movie-carousel"},r.a.createElement(F.Carousel,{infiniteLoop:!0,autoPlay:!0,interval:1e4,showStatus:!1,showIndicators:!1,centerMode:!0,centerSlidePercentage:20,selectedItem:2},t))}},{key:"componentDidMount",value:function(){var e=this;_.a.get("http://localhost:3000/movies/").then(function(t){var a=t.data.map(function(e){return Object(g.a)({},e)});e.setState({movies:a})}).catch(function(t){e.setState({errorMessage:t.message})})}}]),t}(n.Component),x=function(e){return r.a.createElement("div",null,r.a.createElement("h1",null,"Our Movie Store"),r.a.createElement(T,{selectMovieCallback:e.selectMovieCallback}))},D=(a(335),a(337),a(339),a(341),function(e){return r.a.createElement("li",null,r.a.createElement("h3",null,e.name),r.a.createElement("p",null,e.address,", ",e.city," ",e.state),r.a.createElement("p",null,e.phone),r.a.createElement("p",null,"Account Credit: ",e.accountCredit),r.a.createElement("p",null," Movies checked out: ",e.moviesCheckedOutCount))}),Y=function(e){var t=e.customer;return r.a.createElement("section",null,r.a.createElement(q,{buttonType:"selectCustomer",customer:t,selectCustomerCallback:e.selectCustomerCallback}),r.a.createElement(D,{accountCredit:t.account_credit,address:t.address,city:t.city,id:t.id,moviesCheckedOutCount:t.movies_checked_out_count,name:t.name,phone:t.phone,postalCode:t.postal_code,registeredAt:t.registered_at,state:t.state}))},L=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).state={customers:[]},e}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;console.log("Rendered Customers:",this.state.customers);var t=this.state.customers.map(function(t,a){return r.a.createElement(Y,{key:a,customer:t,selectCustomerCallback:e.props.selectCustomerCallback})});return r.a.createElement("div",null,r.a.createElement("ul",null,t))}},{key:"componentDidMount",value:function(){var e=this;_.a.get("http://localhost:3000/customers/").then(function(t){var a=t.data.map(function(e){return Object(g.a)({},e)});e.setState({customers:a})}).catch(function(t){console.log(t.message),e.setState({errorMessage:t.message})})}}]),t}(n.Component),I=function(e){function t(e){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).call(this,e))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null," Customers Page"),r.a.createElement(L,{selectCustomerCallback:this.props.selectCustomerCallback}))}}]),t}(n.Component),W=a(351),H=(a(343),function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).onFormChange=function(t){var a=t.target.value;e.setState({query:a})},e.onSubmitHandler=function(){var t=Object(i.a)(s.a.mark(function t(a){var n,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),""!==(n=e.state.query)){t.next=4;break}return t.abrupt("return",console.log("You must enter a search term :("));case 4:return t.prev=4,t.next=7,e.props.searchTermCallback(n);case 7:r=t.sent,e.props.history.push(r),e.clearForm(),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(4),console.error(t.t0),e.clearForm();case 16:case"end":return t.stop()}},t,this,[[4,12]])}));return function(e){return t.apply(this,arguments)}}(),e.clearForm=function(){e.setState({query:""})},e.state={query:""},e}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=r.a.createElement(E.a,{icon:"search"});return r.a.createElement("section",null,r.a.createElement("form",{onSubmit:this.onSubmitHandler,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"},r.a.createElement("input",{onClick:this.clearForm,className:"searchbar__form-input",onChange:this.onFormChange,value:this.state.query,name:"query",placeholder:"Search movie database by title",size:"40"}),r.a.createElement("button",{className:"button button-search",type:"submit",name:"submit"},e)))}}]),t}(n.Component)),P=Object(W.a)(H),z=(a(346),function(e){var t=function(){console.log("renting movie (POST request)");var t=j()().add(7,"days").format("MMM DD YYYY"),a=e.selectedMovie,n=e.selectedCustomer,r=a.title,c={customer_id:n.id,due_date:t,renderAlertCallback:e.renderAlertCallback},o="http://localhost:3000/rentals/".concat(r,"/check-out");_.a.post(o,c).then(function(e){c.renderAlertCallback({success:"".concat(n.name," has checked out ").concat(a.title,".")}),console.log(e.data)}).catch(function(e){console.log(e.message),c.renderAlertCallback({failure:"This rental could not be created"})})};return r.a.createElement("section",{className:"checkout-form"},r.a.createElement("form",{onSubmit:function(a){a.preventDefault(),e.selectedMovie.title&&e.selectedCustomer.id?(t(),e.resetCheckOutFormCallback()):console.log("did not submit. both fields must be filled out")}},r.a.createElement("div",{className:"checkout-form__movie"},r.a.createElement("label",{htmlFor:"selectedMovie"},e.selectedMovie.title),r.a.createElement("input",{type:"hidden",name:"selectedMovie",value:e.selectedMovie})),r.a.createElement("div",{className:"checkout-form__customer"},r.a.createElement("label",{htmlFor:"selectedCustomer"},e.selectedCustomer.name),r.a.createElement("input",{type:"hidden",name:"selectedCustomer",value:e.selectedCustomer})),r.a.createElement("div",{className:"checkout-form__submit"},r.a.createElement("input",{className:"button button-large ".concat(e.selectedMovie.title&&e.selectedCustomer.name?"":"disabled"),type:"submit",name:"submit",value:"Check Out Now"}))))}),U=a(38),B=a(123);U.b.add(B.a);var J=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).searchTerm=function(){var t=Object(i.a)(s.a.mark(function t(a){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("callback"),console.log(a),"/search",e.setState({query:a}),t.abrupt("return","/search");case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),e.selectMovie=function(t){e.setState({selectedMovie:t})},e.selectCustomer=function(t){e.setState({selectedCustomer:t})},e.renderAlert=function(t){console.log("IN RENDER ALERT"),e.setState({alert:t}),setTimeout(function(){return e.setState({alert:{}})},1e4)},e.resetCheckOutForm=function(){e.setState({selectedMovie:{},selectedCustomer:{}})},e.displayAlert=function(){var t=Object.keys(e.state.alert)[0],a=Object.values(e.state.alert)[0];return r.a.createElement("p",{className:"router__nav-alerts-".concat(t)},"success"===t?r.a.createElement(E.a,{icon:"star"}):"failure"===t?r.a.createElement(E.a,{icon:"ban"}):"warning"===t?r.a.createElement(E.a,{icon:"cog"}):"","  ",a)},e.state={query:"",selectedMovie:{},selectedCustomer:{},alert:{}},e}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=r.a.createElement("section",null,r.a.createElement(f.a,{path:"/video-store-consumer/",exact:!0,component:C}),r.a.createElement(f.a,{path:"/search/",component:function(t){return r.a.createElement(R,Object.assign({},t,{query:e.state.query,renderAlertCallback:e.renderAlert}))}}),r.a.createElement(f.a,{path:"/library/",component:function(t){return r.a.createElement(x,Object.assign({},t,{selectMovieCallback:e.selectMovie}))}}),r.a.createElement(f.a,{path:"/customers/",component:function(t){return r.a.createElement(I,Object.assign({},t,{selectCustomerCallback:e.selectCustomer}))}}));return r.a.createElement(b.a,null,r.a.createElement("div",{className:"router"},r.a.createElement("nav",{className:"router__nav"},r.a.createElement("ul",{className:"router__nav-list"},r.a.createElement("div",{className:"router__nav-navlinks"},r.a.createElement("li",null,r.a.createElement("h4",null,r.a.createElement(p.a,{to:"/video-store-consumer/"},"Home"))),r.a.createElement("li",null,r.a.createElement("h4",null,r.a.createElement(p.a,{to:"/library/"},"Our Movie Store"))),r.a.createElement("li",null,r.a.createElement("h4",null,r.a.createElement(p.a,{to:"/customers/"},"Customers"))),r.a.createElement("li",null,r.a.createElement("h4",null,r.a.createElement(P,{searchTermCallback:this.searchTerm})))),r.a.createElement("div",{className:"router__nav-checkout"},r.a.createElement("li",null,r.a.createElement(z,{selectedMovie:this.state.selectedMovie,selectedCustomer:this.state.selectedCustomer,resetCheckOutFormCallback:this.resetCheckOutForm,renderAlertCallback:this.renderAlert}))),r.a.createElement("div",{className:"router__nav-alerts"},this.displayAlert()))),t))}}]),t}(n.Component),G=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Q(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(J,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/video-store-consumer",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/video-store-consumer","/service-worker.js");G?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Q(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Q(e)})}}()},80:function(e,t,a){}},[[125,2,1]]]);
//# sourceMappingURL=main.0c60e51f.chunk.js.map